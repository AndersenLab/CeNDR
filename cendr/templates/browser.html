{% extends "_layouts/default.html" %}

{% block custom_head %}

<!-- jQuery UI CSS -->
<link rel="stylesheet" type="text/css"
      href="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/themes/smoothness/jquery-ui.css"/>

<!-- Font Awesome CSS -->
<link rel="stylesheet" type="text/css"
      href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css"/>

<!-- IGV CSS -->
<link rel="stylesheet" type="text/css" href="//igv.org/web/release/1.0.0-rc1/igv-1.0.0-rc1.css">

<!-- jQuery JS -->
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/jquery-ui.min.js"></script>


<script type="text/javascript" src="{{ url_for('static', filename = 'js/igv-beta.js') }}"></script>

{% endblock %}


{% block content %}
<div class="row">
      <div class="col-md-12">

<h3 id="region"></h3>

<div id="browser"></div>

      
      </div>
  </div>
{% endblock %}

{% block script %}


<script type="text/javascript">

    $(document).ready(function () {

        var div = $("#browser")[0],
                options = {
                    showNavigation: true,
                    showKaryo: false,
                    reference: {
                      fastaURL: "//storage.googleapis.com/andersen_dist/genome/c_elegans.PRJNA13758.WS245.genomic.fa",
                      indexURL: "//storage.googleapis.com/andersen_dist/genome/c_elegans.PRJNA13758.WS245.genomic.fa.fai",
                      // cytobandURL: ""
                    },
                    locus: "I:1000-2000",
                    tracks: [
                        {
                            name: "Variants",
                            url: "//storage.googleapis.com/andersen_dist/vcf/all/20160408/WI.20160408.filtered.vcf.gz",
                            indexURL: "//storage.googleapis.com/andersen_dist/vcf/all/20160408/WI.20160408.filtered.vcf.gz.tbi",
                            order: Number.MAX_VALUE,
                            displayMode: "SQUISHED",
                            color: "#000000",
                            homvarColor: "#0066ff",
                            homrefColor: "#c2c2d6",
                            visibilityWindow: 20000

                        },
                        {
                            name: "Genes",
                            url: "{{ url_for('static', filename = 'browser/elegans_genes_WS245.bed') }}",
                            indexURL: "{{ url_for('static', filename = 'browser/elegans_genes_WS245.bed') }}",
                            order: 1,
                            displayMode: "EXPANDED"

                        }
                    ]
                };

        igv.createBrowser(div, options);

function refresh_variants() {
    region = $(".igvNavigationSearchInput").val()
    chrom = region.split(":")[0]
    start = region.split(":")[1].split("-")[0].replace(/,/g, "")
    end = region.split(":")[1].split("-")[1].replace(/,/g, "")

    $.ajax({
         url:"/api/gt/" + chrom + "/" + start + "/" + end,
         method: "GET",
         contentType: 'application/json',
         }).done(function(msg) {
          console.log(msg);
        });

}


$("#browser").on("mouseup", function() { 
  console.log("Great")
})

$(".igvNavigationSearchInput").on("input paste", function() {
  console.log("input change");
});


});


</script>





{% endblock %}
